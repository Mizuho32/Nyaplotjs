/**
 * @license almond 0.2.9 Copyright (c) 2011-2014, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

//     Underscore.js 1.6.0
//     http://underscorejs.org
//     (c) 2009-2014 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
//     Underscore may be freely distributed under the MIT license.

!function(t,n){t.Ecoli=n()}(this,function(){var t,n,e;return function(r){function i(t,n){return w.call(t,n)}function a(t,n){var e,r,i,a,o,l,u,c,s,f,p,d=n&&n.split("/"),h=y.map,g=h&&h["*"]||{};if(t&&"."===t.charAt(0))if(n){for(d=d.slice(0,d.length-1),t=t.split("/"),o=t.length-1,y.nodeIdCompat&&b.test(t[o])&&(t[o]=t[o].replace(b,"")),t=d.concat(t),s=0;s<t.length;s+=1)if(p=t[s],"."===p)t.splice(s,1),s-=1;else if(".."===p){if(1===s&&(".."===t[2]||".."===t[0]))break;s>0&&(t.splice(s-1,2),s-=2)}t=t.join("/")}else 0===t.indexOf("./")&&(t=t.substring(2));if((d||g)&&h){for(e=t.split("/"),s=e.length;s>0;s-=1){if(r=e.slice(0,s).join("/"),d)for(f=d.length;f>0;f-=1)if(i=h[d.slice(0,f).join("/")],i&&(i=i[r])){a=i,l=s;break}if(a)break;!u&&g&&g[r]&&(u=g[r],c=s)}!a&&u&&(a=u,l=c),a&&(e.splice(0,l,a),t=e.join("/"))}return t}function o(t,n){return function(){return d.apply(r,_.call(arguments,0).concat([t,n]))}}function l(t){return function(n){return a(n,t)}}function u(t){return function(n){m[t]=n}}function c(t){if(i(v,t)){var n=v[t];delete v[t],x[t]=!0,p.apply(r,n)}if(!i(m,t)&&!i(x,t))throw new Error("No "+t);return m[t]}function s(t){var n,e=t?t.indexOf("!"):-1;return e>-1&&(n=t.substring(0,e),t=t.substring(e+1,t.length)),[n,t]}function f(t){return function(){return y&&y.config&&y.config[t]||{}}}var p,d,h,g,m={},v={},y={},x={},w=Object.prototype.hasOwnProperty,_=[].slice,b=/\.js$/;h=function(t,n){var e,r=s(t),i=r[0];return t=r[1],i&&(i=a(i,n),e=c(i)),i?t=e&&e.normalize?e.normalize(t,l(n)):a(t,n):(t=a(t,n),r=s(t),i=r[0],t=r[1],i&&(e=c(i))),{f:i?i+"!"+t:t,n:t,pr:i,p:e}},g={require:function(t){return o(t)},exports:function(t){var n=m[t];return"undefined"!=typeof n?n:m[t]={}},module:function(t){return{id:t,uri:"",exports:m[t],config:f(t)}}},p=function(t,n,e,a){var l,s,f,p,d,y,w=[],_=typeof e;if(a=a||t,"undefined"===_||"function"===_){for(n=!n.length&&e.length?["require","exports","module"]:n,d=0;d<n.length;d+=1)if(p=h(n[d],a),s=p.f,"require"===s)w[d]=g.require(t);else if("exports"===s)w[d]=g.exports(t),y=!0;else if("module"===s)l=w[d]=g.module(t);else if(i(m,s)||i(v,s)||i(x,s))w[d]=c(s);else{if(!p.p)throw new Error(t+" missing "+s);p.p.load(p.n,o(a,!0),u(s),{}),w[d]=m[s]}f=e?e.apply(m[t],w):void 0,t&&(l&&l.exports!==r&&l.exports!==m[t]?m[t]=l.exports:f===r&&y||(m[t]=f))}else t&&(m[t]=e)},t=n=d=function(t,n,e,i,a){if("string"==typeof t)return g[t]?g[t](n):c(h(t,n).f);if(!t.splice){if(y=t,y.deps&&d(y.deps,y.callback),!n)return;n.splice?(t=n,n=e,e=null):t=r}return n=n||function(){},"function"==typeof e&&(e=i,i=a),i?p(r,t,n,e):setTimeout(function(){p(r,t,n,e)},4),d},d.config=function(t){return d(t)},t._defined=m,e=function(t,n,e){n.splice||(e=n,n=[]),i(m,t)||i(v,t)||(v[t]=[t,n,e])},e.amd={jQuery:!0}}(),e("../lib/almond/almond",function(){}),function(){var t=this,n=t._,r={},i=Array.prototype,a=Object.prototype,o=Function.prototype,l=i.push,u=i.slice,c=i.concat,s=a.toString,f=a.hasOwnProperty,p=i.forEach,d=i.map,h=i.reduce,g=i.reduceRight,m=i.filter,v=i.every,y=i.some,x=i.indexOf,w=i.lastIndexOf,_=Array.isArray,b=Object.keys,k=o.bind,A=function(t){return t instanceof A?t:this instanceof A?void(this._wrapped=t):new A(t)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=A),exports._=A):t._=A,A.VERSION="1.6.0";var D=A.each=A.forEach=function(t,n,e){if(null==t)return t;if(p&&t.forEach===p)t.forEach(n,e);else if(t.length===+t.length){for(var i=0,a=t.length;a>i;i++)if(n.call(e,t[i],i,t)===r)return}else for(var o=A.keys(t),i=0,a=o.length;a>i;i++)if(n.call(e,t[o[i]],o[i],t)===r)return;return t};A.map=A.collect=function(t,n,e){var r=[];return null==t?r:d&&t.map===d?t.map(n,e):(D(t,function(t,i,a){r.push(n.call(e,t,i,a))}),r)};var j="Reduce of empty array with no initial value";A.reduce=A.foldl=A.inject=function(t,n,e,r){var i=arguments.length>2;if(null==t&&(t=[]),h&&t.reduce===h)return r&&(n=A.bind(n,r)),i?t.reduce(n,e):t.reduce(n);if(D(t,function(t,a,o){i?e=n.call(r,e,t,a,o):(e=t,i=!0)}),!i)throw new TypeError(j);return e},A.reduceRight=A.foldr=function(t,n,e,r){var i=arguments.length>2;if(null==t&&(t=[]),g&&t.reduceRight===g)return r&&(n=A.bind(n,r)),i?t.reduceRight(n,e):t.reduceRight(n);var a=t.length;if(a!==+a){var o=A.keys(t);a=o.length}if(D(t,function(l,u,c){u=o?o[--a]:--a,i?e=n.call(r,e,t[u],u,c):(e=t[u],i=!0)}),!i)throw new TypeError(j);return e},A.find=A.detect=function(t,n,e){var r;return M(t,function(t,i,a){return n.call(e,t,i,a)?(r=t,!0):void 0}),r},A.filter=A.select=function(t,n,e){var r=[];return null==t?r:m&&t.filter===m?t.filter(n,e):(D(t,function(t,i,a){n.call(e,t,i,a)&&r.push(t)}),r)},A.reject=function(t,n,e){return A.filter(t,function(t,r,i){return!n.call(e,t,r,i)},e)},A.every=A.all=function(t,n,e){n||(n=A.identity);var i=!0;return null==t?i:v&&t.every===v?t.every(n,e):(D(t,function(t,a,o){return(i=i&&n.call(e,t,a,o))?void 0:r}),!!i)};var M=A.some=A.any=function(t,n,e){n||(n=A.identity);var i=!1;return null==t?i:y&&t.some===y?t.some(n,e):(D(t,function(t,a,o){return i||(i=n.call(e,t,a,o))?r:void 0}),!!i)};A.contains=A.include=function(t,n){return null==t?!1:x&&t.indexOf===x?-1!=t.indexOf(n):M(t,function(t){return t===n})},A.invoke=function(t,n){var e=u.call(arguments,2),r=A.isFunction(n);return A.map(t,function(t){return(r?n:t[n]).apply(t,e)})},A.pluck=function(t,n){return A.map(t,A.property(n))},A.where=function(t,n){return A.filter(t,A.matches(n))},A.findWhere=function(t,n){return A.find(t,A.matches(n))},A.max=function(t,n,e){if(!n&&A.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.max.apply(Math,t);var r=-1/0,i=-1/0;return D(t,function(t,a,o){var l=n?n.call(e,t,a,o):t;l>i&&(r=t,i=l)}),r},A.min=function(t,n,e){if(!n&&A.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.min.apply(Math,t);var r=1/0,i=1/0;return D(t,function(t,a,o){var l=n?n.call(e,t,a,o):t;i>l&&(r=t,i=l)}),r},A.shuffle=function(t){var n,e=0,r=[];return D(t,function(t){n=A.random(e++),r[e-1]=r[n],r[n]=t}),r},A.sample=function(t,n,e){return null==n||e?(t.length!==+t.length&&(t=A.values(t)),t[A.random(t.length-1)]):A.shuffle(t).slice(0,Math.max(0,n))};var E=function(t){return null==t?A.identity:A.isFunction(t)?t:A.property(t)};A.sortBy=function(t,n,e){return n=E(n),A.pluck(A.map(t,function(t,r,i){return{value:t,index:r,criteria:n.call(e,t,r,i)}}).sort(function(t,n){var e=t.criteria,r=n.criteria;if(e!==r){if(e>r||void 0===e)return 1;if(r>e||void 0===r)return-1}return t.index-n.index}),"value")};var O=function(t){return function(n,e,r){var i={};return e=E(e),D(n,function(a,o){var l=e.call(r,a,o,n);t(i,l,a)}),i}};A.groupBy=O(function(t,n,e){A.has(t,n)?t[n].push(e):t[n]=[e]}),A.indexBy=O(function(t,n,e){t[n]=e}),A.countBy=O(function(t,n){A.has(t,n)?t[n]++:t[n]=1}),A.sortedIndex=function(t,n,e,r){e=E(e);for(var i=e.call(r,n),a=0,o=t.length;o>a;){var l=a+o>>>1;e.call(r,t[l])<i?a=l+1:o=l}return a},A.toArray=function(t){return t?A.isArray(t)?u.call(t):t.length===+t.length?A.map(t,A.identity):A.values(t):[]},A.size=function(t){return null==t?0:t.length===+t.length?t.length:A.keys(t).length},A.first=A.head=A.take=function(t,n,e){return null==t?void 0:null==n||e?t[0]:0>n?[]:u.call(t,0,n)},A.initial=function(t,n,e){return u.call(t,0,t.length-(null==n||e?1:n))},A.last=function(t,n,e){return null==t?void 0:null==n||e?t[t.length-1]:u.call(t,Math.max(t.length-n,0))},A.rest=A.tail=A.drop=function(t,n,e){return u.call(t,null==n||e?1:n)},A.compact=function(t){return A.filter(t,A.identity)};var S=function(t,n,e){return n&&A.every(t,A.isArray)?c.apply(e,t):(D(t,function(t){A.isArray(t)||A.isArguments(t)?n?l.apply(e,t):S(t,n,e):e.push(t)}),e)};A.flatten=function(t,n){return S(t,n,[])},A.without=function(t){return A.difference(t,u.call(arguments,1))},A.partition=function(t,n){var e=[],r=[];return D(t,function(t){(n(t)?e:r).push(t)}),[e,r]},A.uniq=A.unique=function(t,n,e,r){A.isFunction(n)&&(r=e,e=n,n=!1);var i=e?A.map(t,e,r):t,a=[],o=[];return D(i,function(e,r){(n?r&&o[o.length-1]===e:A.contains(o,e))||(o.push(e),a.push(t[r]))}),a},A.union=function(){return A.uniq(A.flatten(arguments,!0))},A.intersection=function(t){var n=u.call(arguments,1);return A.filter(A.uniq(t),function(t){return A.every(n,function(n){return A.contains(n,t)})})},A.difference=function(t){var n=c.apply(i,u.call(arguments,1));return A.filter(t,function(t){return!A.contains(n,t)})},A.zip=function(){for(var t=A.max(A.pluck(arguments,"length").concat(0)),n=new Array(t),e=0;t>e;e++)n[e]=A.pluck(arguments,""+e);return n},A.object=function(t,n){if(null==t)return{};for(var e={},r=0,i=t.length;i>r;r++)n?e[t[r]]=n[r]:e[t[r][0]]=t[r][1];return e},A.indexOf=function(t,n,e){if(null==t)return-1;var r=0,i=t.length;if(e){if("number"!=typeof e)return r=A.sortedIndex(t,n),t[r]===n?r:-1;r=0>e?Math.max(0,i+e):e}if(x&&t.indexOf===x)return t.indexOf(n,e);for(;i>r;r++)if(t[r]===n)return r;return-1},A.lastIndexOf=function(t,n,e){if(null==t)return-1;var r=null!=e;if(w&&t.lastIndexOf===w)return r?t.lastIndexOf(n,e):t.lastIndexOf(n);for(var i=r?e:t.length;i--;)if(t[i]===n)return i;return-1},A.range=function(t,n,e){arguments.length<=1&&(n=t||0,t=0),e=arguments[2]||1;for(var r=Math.max(Math.ceil((n-t)/e),0),i=0,a=new Array(r);r>i;)a[i++]=t,t+=e;return a};var F=function(){};A.bind=function(t,n){var e,r;if(k&&t.bind===k)return k.apply(t,u.call(arguments,1));if(!A.isFunction(t))throw new TypeError;return e=u.call(arguments,2),r=function(){if(!(this instanceof r))return t.apply(n,e.concat(u.call(arguments)));F.prototype=t.prototype;var i=new F;F.prototype=null;var a=t.apply(i,e.concat(u.call(arguments)));return Object(a)===a?a:i}},A.partial=function(t){var n=u.call(arguments,1);return function(){for(var e=0,r=n.slice(),i=0,a=r.length;a>i;i++)r[i]===A&&(r[i]=arguments[e++]);for(;e<arguments.length;)r.push(arguments[e++]);return t.apply(this,r)}},A.bindAll=function(t){var n=u.call(arguments,1);if(0===n.length)throw new Error("bindAll must be passed function names");return D(n,function(n){t[n]=A.bind(t[n],t)}),t},A.memoize=function(t,n){var e={};return n||(n=A.identity),function(){var r=n.apply(this,arguments);return A.has(e,r)?e[r]:e[r]=t.apply(this,arguments)}},A.delay=function(t,n){var e=u.call(arguments,2);return setTimeout(function(){return t.apply(null,e)},n)},A.defer=function(t){return A.delay.apply(A,[t,1].concat(u.call(arguments,1)))},A.throttle=function(t,n,e){var r,i,a,o=null,l=0;e||(e={});var u=function(){l=e.leading===!1?0:A.now(),o=null,a=t.apply(r,i),r=i=null};return function(){var c=A.now();l||e.leading!==!1||(l=c);var s=n-(c-l);return r=this,i=arguments,0>=s?(clearTimeout(o),o=null,l=c,a=t.apply(r,i),r=i=null):o||e.trailing===!1||(o=setTimeout(u,s)),a}},A.debounce=function(t,n,e){var r,i,a,o,l,u=function(){var c=A.now()-o;n>c?r=setTimeout(u,n-c):(r=null,e||(l=t.apply(a,i),a=i=null))};return function(){a=this,i=arguments,o=A.now();var c=e&&!r;return r||(r=setTimeout(u,n)),c&&(l=t.apply(a,i),a=i=null),l}},A.once=function(t){var n,e=!1;return function(){return e?n:(e=!0,n=t.apply(this,arguments),t=null,n)}},A.wrap=function(t,n){return A.partial(n,t)},A.compose=function(){var t=arguments;return function(){for(var n=arguments,e=t.length-1;e>=0;e--)n=[t[e].apply(this,n)];return n[0]}},A.after=function(t,n){return function(){return--t<1?n.apply(this,arguments):void 0}},A.keys=function(t){if(!A.isObject(t))return[];if(b)return b(t);var n=[];for(var e in t)A.has(t,e)&&n.push(e);return n},A.values=function(t){for(var n=A.keys(t),e=n.length,r=new Array(e),i=0;e>i;i++)r[i]=t[n[i]];return r},A.pairs=function(t){for(var n=A.keys(t),e=n.length,r=new Array(e),i=0;e>i;i++)r[i]=[n[i],t[n[i]]];return r},A.invert=function(t){for(var n={},e=A.keys(t),r=0,i=e.length;i>r;r++)n[t[e[r]]]=e[r];return n},A.functions=A.methods=function(t){var n=[];for(var e in t)A.isFunction(t[e])&&n.push(e);return n.sort()},A.extend=function(t){return D(u.call(arguments,1),function(n){if(n)for(var e in n)t[e]=n[e]}),t},A.pick=function(t){var n={},e=c.apply(i,u.call(arguments,1));return D(e,function(e){e in t&&(n[e]=t[e])}),n},A.omit=function(t){var n={},e=c.apply(i,u.call(arguments,1));for(var r in t)A.contains(e,r)||(n[r]=t[r]);return n},A.defaults=function(t){return D(u.call(arguments,1),function(n){if(n)for(var e in n)void 0===t[e]&&(t[e]=n[e])}),t},A.clone=function(t){return A.isObject(t)?A.isArray(t)?t.slice():A.extend({},t):t},A.tap=function(t,n){return n(t),t};var q=function(t,n,e,r){if(t===n)return 0!==t||1/t==1/n;if(null==t||null==n)return t===n;t instanceof A&&(t=t._wrapped),n instanceof A&&(n=n._wrapped);var i=s.call(t);if(i!=s.call(n))return!1;switch(i){case"[object String]":return t==String(n);case"[object Number]":return t!=+t?n!=+n:0==t?1/t==1/n:t==+n;case"[object Date]":case"[object Boolean]":return+t==+n;case"[object RegExp]":return t.source==n.source&&t.global==n.global&&t.multiline==n.multiline&&t.ignoreCase==n.ignoreCase}if("object"!=typeof t||"object"!=typeof n)return!1;for(var a=e.length;a--;)if(e[a]==t)return r[a]==n;var o=t.constructor,l=n.constructor;if(o!==l&&!(A.isFunction(o)&&o instanceof o&&A.isFunction(l)&&l instanceof l)&&"constructor"in t&&"constructor"in n)return!1;e.push(t),r.push(n);var u=0,c=!0;if("[object Array]"==i){if(u=t.length,c=u==n.length)for(;u--&&(c=q(t[u],n[u],e,r)););}else{for(var f in t)if(A.has(t,f)&&(u++,!(c=A.has(n,f)&&q(t[f],n[f],e,r))))break;if(c){for(f in n)if(A.has(n,f)&&!u--)break;c=!u}}return e.pop(),r.pop(),c};A.isEqual=function(t,n){return q(t,n,[],[])},A.isEmpty=function(t){if(null==t)return!0;if(A.isArray(t)||A.isString(t))return 0===t.length;for(var n in t)if(A.has(t,n))return!1;return!0},A.isElement=function(t){return!(!t||1!==t.nodeType)},A.isArray=_||function(t){return"[object Array]"==s.call(t)},A.isObject=function(t){return t===Object(t)},D(["Arguments","Function","String","Number","Date","RegExp"],function(t){A["is"+t]=function(n){return s.call(n)=="[object "+t+"]"}}),A.isArguments(arguments)||(A.isArguments=function(t){return!(!t||!A.has(t,"callee"))}),"function"!=typeof/./&&(A.isFunction=function(t){return"function"==typeof t}),A.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},A.isNaN=function(t){return A.isNumber(t)&&t!=+t},A.isBoolean=function(t){return t===!0||t===!1||"[object Boolean]"==s.call(t)},A.isNull=function(t){return null===t},A.isUndefined=function(t){return void 0===t},A.has=function(t,n){return f.call(t,n)},A.noConflict=function(){return t._=n,this},A.identity=function(t){return t},A.constant=function(t){return function(){return t}},A.property=function(t){return function(n){return n[t]}},A.matches=function(t){return function(n){if(n===t)return!0;for(var e in t)if(t[e]!==n[e])return!1;return!0}},A.times=function(t,n,e){for(var r=Array(Math.max(0,t)),i=0;t>i;i++)r[i]=n.call(e,i);return r},A.random=function(t,n){return null==n&&(n=t,t=0),t+Math.floor(Math.random()*(n-t+1))},A.now=Date.now||function(){return(new Date).getTime()};var z={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};z.unescape=A.invert(z.escape);var R={escape:new RegExp("["+A.keys(z.escape).join("")+"]","g"),unescape:new RegExp("("+A.keys(z.unescape).join("|")+")","g")};A.each(["escape","unescape"],function(t){A[t]=function(n){return null==n?"":(""+n).replace(R[t],function(n){return z[t][n]})}}),A.result=function(t,n){if(null==t)return void 0;var e=t[n];return A.isFunction(e)?e.call(t):e},A.mixin=function(t){D(A.functions(t),function(n){var e=A[n]=t[n];A.prototype[n]=function(){var t=[this._wrapped];return l.apply(t,arguments),N.call(this,e.apply(A,t))}})};var C=0;A.uniqueId=function(t){var n=++C+"";return t?t+n:n},A.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var T=/(.)^/,B={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},I=/\\|'|\r|\n|\t|\u2028|\u2029/g;A.template=function(t,n,e){var r;e=A.defaults({},e,A.templateSettings);var i=new RegExp([(e.escape||T).source,(e.interpolate||T).source,(e.evaluate||T).source].join("|")+"|$","g"),a=0,o="__p+='";t.replace(i,function(n,e,r,i,l){return o+=t.slice(a,l).replace(I,function(t){return"\\"+B[t]}),e&&(o+="'+\n((__t=("+e+"))==null?'':_.escape(__t))+\n'"),r&&(o+="'+\n((__t=("+r+"))==null?'':__t)+\n'"),i&&(o+="';\n"+i+"\n__p+='"),a=l+n.length,n}),o+="';\n",e.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{r=new Function(e.variable||"obj","_",o)}catch(l){throw l.source=o,l}if(n)return r(n,A);var u=function(t){return r.call(this,t,A)};return u.source="function("+(e.variable||"obj")+"){\n"+o+"}",u},A.chain=function(t){return A(t).chain()};var N=function(t){return this._chain?A(t).chain():t};A.mixin(A),D(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var n=i[t];A.prototype[t]=function(){var e=this._wrapped;return n.apply(e,arguments),"shift"!=t&&"splice"!=t||0!==e.length||delete e[0],N.call(this,e)}}),D(["concat","join","slice"],function(t){var n=i[t];A.prototype[t]=function(){return N.call(this,n.apply(this._wrapped,arguments))}}),A.extend(A.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}}),"function"==typeof e&&e.amd&&e("underscore",[],function(){return A})}.call(this),e("core/manager",["underscore"],function(t){var n={data_frames:{},panes:[]};return n.addData=function(n,e){entry={},entry[n]=e,t.extend(this.data_frames,entry)},n.getData=function(t){return this.data_frames[t]},n.addPane=function(t){this.panes.push(t)},n.selected=function(n,e){t.each(this.panes,function(t){t.pane.selected(n,e)})},n.updateData=function(){},n}),e("view/diagrams/bar",["underscore","core/manager"],function(t,n){function e(e,r,i,a){var o={value:null,x:null,y:null,width:.9,color:null};arguments.length>3&&t.extend(o,a);var l,u=n.getData(i);if(null!==o.value){var c=this.countData(u.column(o.value));l=this.proceedData(c.x,c.y,o)}else l=this.proceedData(u.column(o.x),u.column(o.y),o);var s;s=null==o.color?d3.scale.category20b():d3.scale.ordinal().range(o.color),this.color_scale=s;var f=e.append("g"),p=f.selectAll("rect").data(l).enter().append("rect").attr("height",0).attr("y",r.y(0)),d=[];return t.each(l,function(t){d.push({label:t.x,color:s(t.x)})}),this.updateModels(p,r,o),this.model=f,this.scales=r,this.options=o,this.legends=d,this.df=u,this.df_id=i,this}return e.prototype.countData=function(n){var e={};return t.each(n,function(t){e[t]=e[t]||0,e[t]+=1}),{x:t.keys(e),y:t.values(e)}},e.prototype.proceedData=function(n,e){return t.map(t.zip(n,e),function(t){return{x:t[0],y:t[1]}})},e.prototype.updateModels=function(t,n,e){var r=this.color_scale,i=function(){d3.select(this).transition().duration(200).attr("fill",function(t){return d3.rgb(r(t.x)).darker(1)})},a=function(){d3.select(this).transition().duration(200).attr("fill",function(t){return r(t.x)})},o=n.x.rangeBand()*e.width,l=n.x.rangeBand()*((1-e.width)/2);t.attr("x",function(t){return n.x(t.x)+l}).attr("width",o).attr("fill",function(t){return r(t.x)}).on("mouseover",i).on("mouseout",a).transition().duration(200).attr("y",function(t){return n.y(t.y)}).attr("height",function(t){return n.y(0)-n.y(t.y)})},e.prototype.selected=function(t,n){var e,r=this.df;if(null!==this.options.value){var i=r.pickUpCells(this.options.value,n),a=this.countData(i);e=this.proceedData(a.x,a.y,this.options)}else{var o=r.pickUpCells(this.options.x,n),l=r.pickUpCells(this.options.y,n);e=this.proceedData(o,l,this.options)}var u=this.model.selectAll("rect").data(e);this.updateModels(u,this.scales,this.options)},e.prototype.update=function(){var t=this.model.selectAll("rect");this.updateModels(t,this.scales,this.options)},e.prototype.checkSelectedData=function(){},e}),e("view/components/filter",["underscore","core/manager"],function(t){function n(n,e,r,i){var a={opacity:.125,color:"gray"};arguments.length>2&&t.extend(a,i);var o=function(){var t={x:l.empty()?e.x.domain():l.extent(),y:e.y.domain()};r(t)},l=d3.svg.brush().x(e.x).on("brushend",o),u=n.append("g"),c=d3.max(e.y.range())-d3.min(e.y.range()),s=d3.min(e.y.range());return u.call(l).selectAll("rect").attr("y",s).attr("height",c).style("fill-opacity",a.opacity).style("fill",a.color).style("shape-rendering","crispEdges"),this}return n}),e("view/diagrams/histogram",["underscore","core/manager","view/components/filter"],function(t,n){function e(e,r,i,a){var o={title:"histogram",value:null,bin_num:20,width:.9,color:"steelblue",stroke_color:"black",stroke_width:1};arguments.length>3&&t.extend(o,a),this.scales=r;var l=n.getData(i),u=this.proceedData(l.column(o.value),o),c=e.append("g"),s=c.selectAll("rect").data(u).enter().append("rect").attr("height",0).attr("y",r.y(0));return this.updateModels(s,r,o),this.legends=[{label:o.title,color:o.color}],this.options=o,this.model=c,this.df=l,this.df_id=i,this}return e.prototype.proceedData=function(t,n){return d3.layout.histogram().bins(this.scales.x.ticks(n.bin_num))(t)},e.prototype.updateModels=function(t,n,e){var r=function(){d3.select(this).transition().duration(200).attr("fill",d3.rgb(e.color).darker(1))},i=function(){d3.select(this).transition().duration(200).attr("fill",e.color)};t.attr("x",function(t){return n.x(t.x)}).attr("width",function(t){return n.x(t.dx)-n.x(0)}).attr("fill",e.color).attr("stroke",e.stroke_color).attr("stroke-width",e.stroke_width).attr("clip-path","url(#clip_context)").on("mouseover",r).on("mouseout",i).transition().duration(200).attr("y",function(t){return n.y(t.y)}).attr("height",function(t){return n.y(0)-n.y(t.y)})},e.prototype.selected=function(t,n){var e=this.df.pickUpCells(this.options.value,n),t=this.proceedData(e,this.options),r=this.model.selectAll("rect").data(t);this.updateModels(r,this.scales,this.options)},e.prototype.update=function(){var t=this.model.selectAll("rect");this.updateModels(t,this.scales,this.options)},e.prototype.checkSelectedData=function(e){var r=[],i=this.df.column(this.options.value);t.each(i,function(t,n){t>e.x[0]&&t<e.x[1]&&r.push(n)}),n.selected(this.df_id,r)},e}),e("view/diagrams/scatter",["underscore","core/manager","view/components/filter"],function(t,n){function e(e,r,i,a){var o={title:"scatter",x:null,y:null,r:5,shape:"circle",color:"steelblue",stroke_color:"black",stroke_width:1};arguments.length>3&&t.extend(o,a),this.scales=r;var l=n.getData(i),u=this.proceedData(l.column(o.x),l.column(o.y),o),c=e.append("g"),s=c.selectAll("circle").data(u).enter().append("circle").attr("r",0);return this.updateModels(s,r,o),this.legends=[{label:o.title,color:o.color}],this.options=o,this.model=c,this.df=l,this.df_id=i,this}return e.prototype.proceedData=function(n,e){return t.map(t.zip(n,e),function(t){return{x:t[0],y:t[1]}})},e.prototype.updateModels=function(t,n,e){var r=function(){d3.select(this).transition().duration(200).attr("fill",d3.rgb(e.color).darker(1))},i=function(){d3.select(this).transition().duration(200).attr("fill",e.color)};t.attr("cx",function(t){return n.x(t.x)}).attr("cy",function(t){return n.y(t.y)}).attr("fill",e.color).attr("stroke",e.stroke_color).attr("stroke-width",e.stroke_width).attr("clip-path","url(#clip_context)").on("mouseover",r).on("mouseout",i).transition().duration(200).attr("r",e.r)},e.prototype.selected=function(t,n){var e=this.df.pickUpCells(this.options.value,n),t=this.proceedData(e,this.options),r=this.model.selectAll("rect").data(t);this.updateModels(r,this.scales,this.options)},e.prototype.update=function(){var t=this.model.selectAll("rect");this.updateModels(t,this.scales,this.options)},e.prototype.checkSelectedData=function(e){var r=[],i=this.df.column(this.options.value);t.each(i,function(t,n){t>e.x[0]&&t<e.x[1]&&r.push(n)}),n.selected(this.df_id,r)},e}),e("view/diagrams/line",["underscore","core/manager","view/components/filter"],function(t,n){function e(e,r,i,a){var o={x:null,y:null,title:"line",color:"steelblue",stroke_width:2};arguments.length>3&&t.extend(o,a),this.scales=r;var l=n.getData(i),u=this.proceedData(l.column(o.x),l.column(o.y),o),c=e.append("g"),s=c.append("path").datum(u);return this.updateModels(s,r,o),this.legends=[{label:o.title,color:o.color}],this.options=o,this.model=c,this.df=l,this.df_id=i,this}return e.prototype.proceedData=function(n,e){return t.map(t.zip(n,e),function(t){return{x:t[0],y:t[1]}})},e.prototype.updateModels=function(t,n,e){var r=d3.svg.line().x(function(t){return n.x(t.x)}).y(function(t){return n.y(t.y)});t.attr("d",r).attr("stroke",e.color).attr("stroke-width",e.stroke_width).attr("fill","none")},e.prototype.selected=function(t,n){var e=this.df.pickUpCells(this.options.value,n),t=this.proceedData(e,this.options),r=this.model.selectAll("path").datum(t);this.updateModels(r,this.scales,this.options)},e.prototype.update=function(){var t=this.model.selectAll("path");this.updateModels(t,this.scales,this.options)},e.prototype.checkSelectedData=function(e){var r=[],i=this.df.column(this.options.value);t.each(i,function(t,n){t>e.x[0]&&t<e.x[1]&&r.push(n)}),n.selected(this.df_id,r)},e}),e("view/diagrams/venn",["underscore","core/manager","view/components/filter"],function(t,n){function e(e,r,i,a){var o={category:null,count:null,color:null,stroke_color:"#000",stroke_width:1,opacity:.5};arguments.length>3&&t.extend(o,a),this.scales=r;var l=n.getData(i),u=this.proceedData(l.column(o.category),l.column(o.count),o),c=e.append("g"),s=c.selectAll("circle").data(u).enter().append("circle");return this.color_scale=null==o.color?d3.scale.category20b():d3.scale.ordinal().range(o.color),this.updateModels(s,r,o),this.options=o,this.model=c,this.df=l,this.df_id=i,this}return e.prototype.proceedData=function(){return["hoge","fuga","nyaa"]},e.prototype.updateModels=function(t,n,e){var r=this.color_scale,i=function(){d3.select(this).transition().duration(200).attr("fill",function(t){return d3.rgb(r(t)).darker(1)})},a=function(){d3.select(this).transition().duration(200).attr("fill",function(t){return r(t)})},o=d3.max(n.x.range())/4,l=(d3.max(n.y.range())-o*Math.sqrt(3))/2,u=l+o*Math.sqrt(3),c=d3.scale.ordinal().domain(["hoge","fuga","nyaa"]).range([2*o,o+40,3*o-40]),s=d3.scale.ordinal().domain(["hoge","fuga","nyaa"]).range([l,u-40,u-40]);t.attr("r",100).attr("cx",function(t){return c(t)}).attr("cy",function(t){return s(t)}).attr("stroke",e.stroke_color).attr("stroke-width",e.stroke_width).attr("fill",function(t){return r(t)}).attr("fill-opacity",e.opacity).on("mouseover",i).on("mouseout",a),t.append("text").attr("x",function(t){return c(t)}).attr("y",function(t){return s(t)}).attr("text-anchor","middle").text(function(t){return t})},e.prototype.selected=function(t,n){var e=this.df.pickUpCells(this.options.value,n),t=this.proceedData(e,this.options),r=this.model.selectAll("path").datum(t);this.updateModels(r,this.scales,this.options)},e.prototype.update=function(){var t=this.model.selectAll("path");this.updateModels(t,this.scales,this.options)},e.prototype.checkSelectedData=function(e){var r=[],i=this.df.column(this.options.value);t.each(i,function(t,n){t>e.x[0]&&t<e.x[1]&&r.push(n)}),n.selected(this.df_id,r)},e.prototype.legends=function(){return[]},e}),e("view/diagrams/diagrams",["require","exports","module","view/diagrams/bar","view/diagrams/histogram","view/diagrams/scatter","view/diagrams/line","view/diagrams/venn"],function(t){return diagrams={},diagrams.bar=t("view/diagrams/bar"),diagrams.histogram=t("view/diagrams/histogram"),diagrams.scatter=t("view/diagrams/scatter"),diagrams.line=t("view/diagrams/line"),diagrams.venn=t("view/diagrams/venn"),diagrams}),e("view/components/axis",["underscore"],function(t){function n(n,e,r){var i={width:0,height:0,margin:{top:0,bottom:0,left:0,right:0},stroke_color:"#fff",stroke_width:1,x_label:"X",y_label:"Y",grid:!0};arguments.length>2&&t.extend(i,r);var a=d3.svg.axis().scale(e.x).orient("bottom"),o=d3.svg.axis().scale(e.y).orient("left");return i.grid&&(a.tickSize(-1*i.height),o.tickSize(-1*i.width)),n.append("g").attr("class","x_axis").attr("transform","translate(0,"+i.height+")").call(a),n.append("g").attr("class","y_axis").call(o),n.selectAll(".x_axis, .y_axis").selectAll("path, line").style("fill","none").style("stroke",i.stroke_color).style("stroke-width",i.stroke_width),n.append("text").attr("x",i.width/2).attr("y",i.height+i.margin.bottom/1.5).attr("text-anchor","middle").attr("fill","black").attr("font-size",22).text(i.x_label),n.append("text").attr("x",-i.margin.left/1.5).attr("y",i.height/2).attr("text-anchor","middle").attr("fill","black").attr("font-size",22).attr("transform","rotate(-90,"+-i.margin.left/1.5+","+i.height/2+")").text(i.y_label),this.xAxis=a,this.yAxis=o,this.model=n,this}return n.prototype.update=function(){this.model.selectAll(".x_axis").call(this.xAxis),this.model.selectAll(".y_axis").call(this.yAxis)},n}),e("view/components/legend",["underscore","core/manager"],function(t){function n(n,e){var r={title:"",width:100,height:500,fill_color:"none",stroke_color:"#000",stroke_width:0,title_height:15,margin:{top:18,bottom:8,right:8,left:18},middle:!1};arguments.length>1&&t.extend(r,e),n.append("rect").attr("width",r.width).attr("height",r.height).attr("x",0).attr("y",0).attr("fill",r.fill_color).attr("stroke",r.stroke_color).attr("stroke-width",r.stroke_width);var i=n.append("g").attr("transform","translate("+r.margin.left+","+r.margin.top+")");return i.append("text").attr("x",0).attr("y",0).text(r.title),this.model=i,this.options=r,this.data=[],this}return n.prototype.add=function(t,n,e){this.data.push({label:t,color:n,callback:e});var r=this.model.selectAll("g").data(this.data).enter().append("g"),i=this.options.title_height;if(r.attr("transform",function(t,n){return"translate(0,"+(i+25*n)+")"}).append("circle").attr("cx","8").attr("cy","8").attr("r","6").attr("stroke",function(t){return t.color}).attr("stroke-width","2").attr("fill",function(t){return t.color}).on("click",function(t){var n=d3.select(this);return n.attr("fill-opacity",1==n.attr("fill-opacity")?0:1),t.callback()}).style("cursor","pointer"),r.append("text").attr("x","18").attr("y","12").attr("font-size","12").text(function(t){return t.label}),this.options.middle){var a=i+25*this.data.length;this.model.attr("transform","translate("+this.options.margin.left+","+(this.options.height-a)/2+")")}},n}),e("view/pane",["underscore","view/diagrams/diagrams","view/components/axis","view/components/filter","view/components/legend"],function(t,n,e,r,i){function a(n,r){var a={width:700,height:500,margin:{top:30,bottom:80,left:80,right:30},xrange:[0,0],yrange:[0,0],x_label:"X",y_label:"Y",zoom:!0,grid:!0,scale:"fixed",bg_color:"#eee",grid_color:"#fff",legend:!0,legend_width:100,legend_options:{}};arguments.length>1&&t.extend(a,r);var o=n.append("svg").attr("width",a.width).attr("height",a.height),l=a.width-a.margin.left-a.margin.right,u=a.height-a.margin.top-a.margin.bottom;a.legend&&(l-=a.legend_width);var c={x:[0,l],y:[u,0]},s={};t.each({x:"xrange",y:"yrange"},function(n,e){s[e]=a[n].length>2||t.any(a[n],function(t){return!isFinite(t)})?d3.scale.ordinal().domain(a[n]).rangeBands(c[e]):d3.scale.linear().domain(a[n]).range(c[e])}),o.append("g").attr("transform","translate("+a.margin.left+","+a.margin.top+")").append("rect").attr("x",0).attr("y",0).attr("width",l).attr("height",u).attr("stroke","#000000").attr("stroke_width",2).attr("fill",a.bg_color);new e(o.select("g"),s,{width:l,height:u,margin:a.margin,grid:a.grid,x_label:a.x_label,y_label:a.y_label,stroke_color:a.grid_color});if(o.select("g").append("g").attr("class","context").append("clipPath").attr("id","clip_context").append("rect").attr("x",0).attr("y",0).attr("width",l).attr("height",u),a.legend){var f=o.select("g").append("g").attr("transform","translate("+l+",0)");a.legend_options.height=u,this.legend=new i(f,a.legend_options)}return this.diagrams=[],this.context=o.select(".context"),this.scales=s,this.options=a,this.filter=null,this}return a.prototype.addDiagram=function(e,r,i){var a=new n[e](this.context,this.scales,r,i),o=this.legend;this.options.legend&&t.each(a.legends,function(t){o.add(t.label,t.color,function(){console.log("hoge")})}),this.diagrams.push(a)},a.prototype.addFilter=function(n,e){var i=this.diagrams,a=function(n){t.each(i,function(t){t.checkSelectedData(n)
})};this.filter=new r(this.context,this.scales,a,e)},a.prototype.selected=function(n,e){var r=this.diagrams,i={fixed:function(){},fluid:function(){t.each(r,function(t){t.df_id==n&&t.selected(n,e)})}};i[this.options.scale]()},a}),e("utils/dataframe",["underscore"],function(t){function n(t,n){return this.raw=n,this}return n.prototype.row=function(t){return this.raw[t]},n.prototype.column=function(n){var e=[],r=this.raw;return t.each(r,function(t){e.push(t[n])}),e},n.prototype.pickUpCells=function(n,e){var r=this.column(n);return t.map(e,function(t){return r[t]})},n.prototype.columnRange=function(t){var n=this.column(t);return{max:d3.max(n,function(t){return t}),min:d3.min(n,function(t){return t})}},n}),e("core/parse",["underscore","core/manager","view/pane","utils/dataframe"],function(t,n,e,r){function i(i,a){element=d3.select(a),t.each(i.data,function(t,e){n.addData(e,new r(e,t))}),t.each(i.panes,function(r){var i=new e(element,r.options),a=[];if(t.each(r.diagrams,function(t){i.addDiagram(t.type,t.data,t.options||{}),a.push(t.data)}),void 0!==r.filter){var o=r.filter;i.addFilter(o.type,o.options||{})}n.addPane({pane:i,data:a})})}return i}),e("main",["require","exports","module","core/parse"],function(t){return Ecoli={},Ecoli.core={},Ecoli.core.parse=t("core/parse"),Ecoli}),n("main")});