/**
 * @license almond 0.2.9 Copyright (c) 2011-2014, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

//     Underscore.js 1.6.0
//     http://underscorejs.org
//     (c) 2009-2014 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
//     Underscore may be freely distributed under the MIT license.

//     uuid.js
//
//     Copyright (c) 2010-2012 Robert Kieffer
//     MIT License - http://opensource.org/licenses/mit-license.php

!function(t,n){t.Nyaplot=n()}(this,function(){var t,n,r;return function(e){function i(t,n){return _.call(t,n)}function o(t,n){var r,e,i,o,u,a,c,l,s,f,p,d=n&&n.split("/"),h=v.map,g=h&&h["*"]||{};if(t&&"."===t.charAt(0))if(n){for(d=d.slice(0,d.length-1),t=t.split("/"),u=t.length-1,v.nodeIdCompat&&b.test(t[u])&&(t[u]=t[u].replace(b,"")),t=d.concat(t),s=0;s<t.length;s+=1)if(p=t[s],"."===p)t.splice(s,1),s-=1;else if(".."===p){if(1===s&&(".."===t[2]||".."===t[0]))break;s>0&&(t.splice(s-1,2),s-=2)}t=t.join("/")}else 0===t.indexOf("./")&&(t=t.substring(2));if((d||g)&&h){for(r=t.split("/"),s=r.length;s>0;s-=1){if(e=r.slice(0,s).join("/"),d)for(f=d.length;f>0;f-=1)if(i=h[d.slice(0,f).join("/")],i&&(i=i[e])){o=i,a=s;break}if(o)break;!c&&g&&g[e]&&(c=g[e],l=s)}!o&&c&&(o=c,a=l),o&&(r.splice(0,a,o),t=r.join("/"))}return t}function u(t,n){return function(){return d.apply(e,w.call(arguments,0).concat([t,n]))}}function a(t){return function(n){return o(n,t)}}function c(t){return function(n){y[t]=n}}function l(t){if(i(m,t)){var n=m[t];delete m[t],x[t]=!0,p.apply(e,n)}if(!i(y,t)&&!i(x,t))throw new Error("No "+t);return y[t]}function s(t){var n,r=t?t.indexOf("!"):-1;return r>-1&&(n=t.substring(0,r),t=t.substring(r+1,t.length)),[n,t]}function f(t){return function(){return v&&v.config&&v.config[t]||{}}}var p,d,h,g,y={},m={},v={},x={},_=Object.prototype.hasOwnProperty,w=[].slice,b=/\.js$/;h=function(t,n){var r,e=s(t),i=e[0];return t=e[1],i&&(i=o(i,n),r=l(i)),i?t=r&&r.normalize?r.normalize(t,a(n)):o(t,n):(t=o(t,n),e=s(t),i=e[0],t=e[1],i&&(r=l(i))),{f:i?i+"!"+t:t,n:t,pr:i,p:r}},g={require:function(t){return u(t)},exports:function(t){var n=y[t];return"undefined"!=typeof n?n:y[t]={}},module:function(t){return{id:t,uri:"",exports:y[t],config:f(t)}}},p=function(t,n,r,o){var a,s,f,p,d,v,_=[],w=typeof r;if(o=o||t,"undefined"===w||"function"===w){for(n=!n.length&&r.length?["require","exports","module"]:n,d=0;d<n.length;d+=1)if(p=h(n[d],o),s=p.f,"require"===s)_[d]=g.require(t);else if("exports"===s)_[d]=g.exports(t),v=!0;else if("module"===s)a=_[d]=g.module(t);else if(i(y,s)||i(m,s)||i(x,s))_[d]=l(s);else{if(!p.p)throw new Error(t+" missing "+s);p.p.load(p.n,u(o,!0),c(s),{}),_[d]=y[s]}f=r?r.apply(y[t],_):void 0,t&&(a&&a.exports!==e&&a.exports!==y[t]?y[t]=a.exports:f===e&&v||(y[t]=f))}else t&&(y[t]=r)},t=n=d=function(t,n,r,i,o){if("string"==typeof t)return g[t]?g[t](n):l(h(t,n).f);if(!t.splice){if(v=t,v.deps&&d(v.deps,v.callback),!n)return;n.splice?(t=n,n=r,r=null):t=e}return n=n||function(){},"function"==typeof r&&(r=i,i=o),i?p(e,t,n,r):setTimeout(function(){p(e,t,n,r)},4),d},d.config=function(t){return d(t)},t._defined=y,r=function(t,n,r){n.splice||(r=n,n=[]),i(y,t)||i(m,t)||(m[t]=[t,n,r])},r.amd={jQuery:!0}}(),r("../contrib/almond/almond",function(){}),function(){var t=this,n=t._,e={},i=Array.prototype,o=Object.prototype,u=Function.prototype,a=i.push,c=i.slice,l=i.concat,s=o.toString,f=o.hasOwnProperty,p=i.forEach,d=i.map,h=i.reduce,g=i.reduceRight,y=i.filter,m=i.every,v=i.some,x=i.indexOf,_=i.lastIndexOf,w=Array.isArray,b=Object.keys,k=u.bind,A=function(t){return t instanceof A?t:this instanceof A?void(this._wrapped=t):new A(t)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=A),exports._=A):t._=A,A.VERSION="1.6.0";var j=A.each=A.forEach=function(t,n,r){if(null==t)return t;if(p&&t.forEach===p)t.forEach(n,r);else if(t.length===+t.length){for(var i=0,o=t.length;o>i;i++)if(n.call(r,t[i],i,t)===e)return}else for(var u=A.keys(t),i=0,o=u.length;o>i;i++)if(n.call(r,t[u[i]],u[i],t)===e)return;return t};A.map=A.collect=function(t,n,r){var e=[];return null==t?e:d&&t.map===d?t.map(n,r):(j(t,function(t,i,o){e.push(n.call(r,t,i,o))}),e)};var O="Reduce of empty array with no initial value";A.reduce=A.foldl=A.inject=function(t,n,r,e){var i=arguments.length>2;if(null==t&&(t=[]),h&&t.reduce===h)return e&&(n=A.bind(n,e)),i?t.reduce(n,r):t.reduce(n);if(j(t,function(t,o,u){i?r=n.call(e,r,t,o,u):(r=t,i=!0)}),!i)throw new TypeError(O);return r},A.reduceRight=A.foldr=function(t,n,r,e){var i=arguments.length>2;if(null==t&&(t=[]),g&&t.reduceRight===g)return e&&(n=A.bind(n,e)),i?t.reduceRight(n,r):t.reduceRight(n);var o=t.length;if(o!==+o){var u=A.keys(t);o=u.length}if(j(t,function(a,c,l){c=u?u[--o]:--o,i?r=n.call(e,r,t[c],c,l):(r=t[c],i=!0)}),!i)throw new TypeError(O);return r},A.find=A.detect=function(t,n,r){var e;return E(t,function(t,i,o){return n.call(r,t,i,o)?(e=t,!0):void 0}),e},A.filter=A.select=function(t,n,r){var e=[];return null==t?e:y&&t.filter===y?t.filter(n,r):(j(t,function(t,i,o){n.call(r,t,i,o)&&e.push(t)}),e)},A.reject=function(t,n,r){return A.filter(t,function(t,e,i){return!n.call(r,t,e,i)},r)},A.every=A.all=function(t,n,r){n||(n=A.identity);var i=!0;return null==t?i:m&&t.every===m?t.every(n,r):(j(t,function(t,o,u){return(i=i&&n.call(r,t,o,u))?void 0:e}),!!i)};var E=A.some=A.any=function(t,n,r){n||(n=A.identity);var i=!1;return null==t?i:v&&t.some===v?t.some(n,r):(j(t,function(t,o,u){return i||(i=n.call(r,t,o,u))?e:void 0}),!!i)};A.contains=A.include=function(t,n){return null==t?!1:x&&t.indexOf===x?-1!=t.indexOf(n):E(t,function(t){return t===n})},A.invoke=function(t,n){var r=c.call(arguments,2),e=A.isFunction(n);return A.map(t,function(t){return(e?n:t[n]).apply(t,r)})},A.pluck=function(t,n){return A.map(t,A.property(n))},A.where=function(t,n){return A.filter(t,A.matches(n))},A.findWhere=function(t,n){return A.find(t,A.matches(n))},A.max=function(t,n,r){if(!n&&A.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.max.apply(Math,t);var e=-1/0,i=-1/0;return j(t,function(t,o,u){var a=n?n.call(r,t,o,u):t;a>i&&(e=t,i=a)}),e},A.min=function(t,n,r){if(!n&&A.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.min.apply(Math,t);var e=1/0,i=1/0;return j(t,function(t,o,u){var a=n?n.call(r,t,o,u):t;i>a&&(e=t,i=a)}),e},A.shuffle=function(t){var n,r=0,e=[];return j(t,function(t){n=A.random(r++),e[r-1]=e[n],e[n]=t}),e},A.sample=function(t,n,r){return null==n||r?(t.length!==+t.length&&(t=A.values(t)),t[A.random(t.length-1)]):A.shuffle(t).slice(0,Math.max(0,n))};var q=function(t){return null==t?A.identity:A.isFunction(t)?t:A.property(t)};A.sortBy=function(t,n,r){return n=q(n),A.pluck(A.map(t,function(t,e,i){return{value:t,index:e,criteria:n.call(r,t,e,i)}}).sort(function(t,n){var r=t.criteria,e=n.criteria;if(r!==e){if(r>e||void 0===r)return 1;if(e>r||void 0===e)return-1}return t.index-n.index}),"value")};var F=function(t){return function(n,r,e){var i={};return r=q(r),j(n,function(o,u){var a=r.call(e,o,u,n);t(i,a,o)}),i}};A.groupBy=F(function(t,n,r){A.has(t,n)?t[n].push(r):t[n]=[r]}),A.indexBy=F(function(t,n,r){t[n]=r}),A.countBy=F(function(t,n){A.has(t,n)?t[n]++:t[n]=1}),A.sortedIndex=function(t,n,r,e){r=q(r);for(var i=r.call(e,n),o=0,u=t.length;u>o;){var a=o+u>>>1;r.call(e,t[a])<i?o=a+1:u=a}return o},A.toArray=function(t){return t?A.isArray(t)?c.call(t):t.length===+t.length?A.map(t,A.identity):A.values(t):[]},A.size=function(t){return null==t?0:t.length===+t.length?t.length:A.keys(t).length},A.first=A.head=A.take=function(t,n,r){return null==t?void 0:null==n||r?t[0]:0>n?[]:c.call(t,0,n)},A.initial=function(t,n,r){return c.call(t,0,t.length-(null==n||r?1:n))},A.last=function(t,n,r){return null==t?void 0:null==n||r?t[t.length-1]:c.call(t,Math.max(t.length-n,0))},A.rest=A.tail=A.drop=function(t,n,r){return c.call(t,null==n||r?1:n)},A.compact=function(t){return A.filter(t,A.identity)};var R=function(t,n,r){return n&&A.every(t,A.isArray)?l.apply(r,t):(j(t,function(t){A.isArray(t)||A.isArguments(t)?n?a.apply(r,t):R(t,n,r):r.push(t)}),r)};A.flatten=function(t,n){return R(t,n,[])},A.without=function(t){return A.difference(t,c.call(arguments,1))},A.partition=function(t,n){var r=[],e=[];return j(t,function(t){(n(t)?r:e).push(t)}),[r,e]},A.uniq=A.unique=function(t,n,r,e){A.isFunction(n)&&(e=r,r=n,n=!1);var i=r?A.map(t,r,e):t,o=[],u=[];return j(i,function(r,e){(n?e&&u[u.length-1]===r:A.contains(u,r))||(u.push(r),o.push(t[e]))}),o},A.union=function(){return A.uniq(A.flatten(arguments,!0))},A.intersection=function(t){var n=c.call(arguments,1);return A.filter(A.uniq(t),function(t){return A.every(n,function(n){return A.contains(n,t)})})},A.difference=function(t){var n=l.apply(i,c.call(arguments,1));return A.filter(t,function(t){return!A.contains(n,t)})},A.zip=function(){for(var t=A.max(A.pluck(arguments,"length").concat(0)),n=new Array(t),r=0;t>r;r++)n[r]=A.pluck(arguments,""+r);return n},A.object=function(t,n){if(null==t)return{};for(var r={},e=0,i=t.length;i>e;e++)n?r[t[e]]=n[e]:r[t[e][0]]=t[e][1];return r},A.indexOf=function(t,n,r){if(null==t)return-1;var e=0,i=t.length;if(r){if("number"!=typeof r)return e=A.sortedIndex(t,n),t[e]===n?e:-1;e=0>r?Math.max(0,i+r):r}if(x&&t.indexOf===x)return t.indexOf(n,r);for(;i>e;e++)if(t[e]===n)return e;return-1},A.lastIndexOf=function(t,n,r){if(null==t)return-1;var e=null!=r;if(_&&t.lastIndexOf===_)return e?t.lastIndexOf(n,r):t.lastIndexOf(n);for(var i=e?r:t.length;i--;)if(t[i]===n)return i;return-1},A.range=function(t,n,r){arguments.length<=1&&(n=t||0,t=0),r=arguments[2]||1;for(var e=Math.max(Math.ceil((n-t)/r),0),i=0,o=new Array(e);e>i;)o[i++]=t,t+=r;return o};var S=function(){};A.bind=function(t,n){var r,e;if(k&&t.bind===k)return k.apply(t,c.call(arguments,1));if(!A.isFunction(t))throw new TypeError;return r=c.call(arguments,2),e=function(){if(!(this instanceof e))return t.apply(n,r.concat(c.call(arguments)));S.prototype=t.prototype;var i=new S;S.prototype=null;var o=t.apply(i,r.concat(c.call(arguments)));return Object(o)===o?o:i}},A.partial=function(t){var n=c.call(arguments,1);return function(){for(var r=0,e=n.slice(),i=0,o=e.length;o>i;i++)e[i]===A&&(e[i]=arguments[r++]);for(;r<arguments.length;)e.push(arguments[r++]);return t.apply(this,e)}},A.bindAll=function(t){var n=c.call(arguments,1);if(0===n.length)throw new Error("bindAll must be passed function names");return j(n,function(n){t[n]=A.bind(t[n],t)}),t},A.memoize=function(t,n){var r={};return n||(n=A.identity),function(){var e=n.apply(this,arguments);return A.has(r,e)?r[e]:r[e]=t.apply(this,arguments)}},A.delay=function(t,n){var r=c.call(arguments,2);return setTimeout(function(){return t.apply(null,r)},n)},A.defer=function(t){return A.delay.apply(A,[t,1].concat(c.call(arguments,1)))},A.throttle=function(t,n,r){var e,i,o,u=null,a=0;r||(r={});var c=function(){a=r.leading===!1?0:A.now(),u=null,o=t.apply(e,i),e=i=null};return function(){var l=A.now();a||r.leading!==!1||(a=l);var s=n-(l-a);return e=this,i=arguments,0>=s?(clearTimeout(u),u=null,a=l,o=t.apply(e,i),e=i=null):u||r.trailing===!1||(u=setTimeout(c,s)),o}},A.debounce=function(t,n,r){var e,i,o,u,a,c=function(){var l=A.now()-u;n>l?e=setTimeout(c,n-l):(e=null,r||(a=t.apply(o,i),o=i=null))};return function(){o=this,i=arguments,u=A.now();var l=r&&!e;return e||(e=setTimeout(c,n)),l&&(a=t.apply(o,i),o=i=null),a}},A.once=function(t){var n,r=!1;return function(){return r?n:(r=!0,n=t.apply(this,arguments),t=null,n)}},A.wrap=function(t,n){return A.partial(n,t)},A.compose=function(){var t=arguments;return function(){for(var n=arguments,r=t.length-1;r>=0;r--)n=[t[r].apply(this,n)];return n[0]}},A.after=function(t,n){return function(){return--t<1?n.apply(this,arguments):void 0}},A.keys=function(t){if(!A.isObject(t))return[];if(b)return b(t);var n=[];for(var r in t)A.has(t,r)&&n.push(r);return n},A.values=function(t){for(var n=A.keys(t),r=n.length,e=new Array(r),i=0;r>i;i++)e[i]=t[n[i]];return e},A.pairs=function(t){for(var n=A.keys(t),r=n.length,e=new Array(r),i=0;r>i;i++)e[i]=[n[i],t[n[i]]];return e},A.invert=function(t){for(var n={},r=A.keys(t),e=0,i=r.length;i>e;e++)n[t[r[e]]]=r[e];return n},A.functions=A.methods=function(t){var n=[];for(var r in t)A.isFunction(t[r])&&n.push(r);return n.sort()},A.extend=function(t){return j(c.call(arguments,1),function(n){if(n)for(var r in n)t[r]=n[r]}),t},A.pick=function(t){var n={},r=l.apply(i,c.call(arguments,1));return j(r,function(r){r in t&&(n[r]=t[r])}),n},A.omit=function(t){var n={},r=l.apply(i,c.call(arguments,1));for(var e in t)A.contains(r,e)||(n[e]=t[e]);return n},A.defaults=function(t){return j(c.call(arguments,1),function(n){if(n)for(var r in n)void 0===t[r]&&(t[r]=n[r])}),t},A.clone=function(t){return A.isObject(t)?A.isArray(t)?t.slice():A.extend({},t):t},A.tap=function(t,n){return n(t),t};var N=function(t,n,r,e){if(t===n)return 0!==t||1/t==1/n;if(null==t||null==n)return t===n;t instanceof A&&(t=t._wrapped),n instanceof A&&(n=n._wrapped);var i=s.call(t);if(i!=s.call(n))return!1;switch(i){case"[object String]":return t==String(n);case"[object Number]":return t!=+t?n!=+n:0==t?1/t==1/n:t==+n;case"[object Date]":case"[object Boolean]":return+t==+n;case"[object RegExp]":return t.source==n.source&&t.global==n.global&&t.multiline==n.multiline&&t.ignoreCase==n.ignoreCase}if("object"!=typeof t||"object"!=typeof n)return!1;for(var o=r.length;o--;)if(r[o]==t)return e[o]==n;var u=t.constructor,a=n.constructor;if(u!==a&&!(A.isFunction(u)&&u instanceof u&&A.isFunction(a)&&a instanceof a)&&"constructor"in t&&"constructor"in n)return!1;r.push(t),e.push(n);var c=0,l=!0;if("[object Array]"==i){if(c=t.length,l=c==n.length)for(;c--&&(l=N(t[c],n[c],r,e)););}else{for(var f in t)if(A.has(t,f)&&(c++,!(l=A.has(n,f)&&N(t[f],n[f],r,e))))break;if(l){for(f in n)if(A.has(n,f)&&!c--)break;l=!c}}return r.pop(),e.pop(),l};A.isEqual=function(t,n){return N(t,n,[],[])},A.isEmpty=function(t){if(null==t)return!0;if(A.isArray(t)||A.isString(t))return 0===t.length;for(var n in t)if(A.has(t,n))return!1;return!0},A.isElement=function(t){return!(!t||1!==t.nodeType)},A.isArray=w||function(t){return"[object Array]"==s.call(t)},A.isObject=function(t){return t===Object(t)},j(["Arguments","Function","String","Number","Date","RegExp"],function(t){A["is"+t]=function(n){return s.call(n)=="[object "+t+"]"}}),A.isArguments(arguments)||(A.isArguments=function(t){return!(!t||!A.has(t,"callee"))}),"function"!=typeof/./&&(A.isFunction=function(t){return"function"==typeof t}),A.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},A.isNaN=function(t){return A.isNumber(t)&&t!=+t},A.isBoolean=function(t){return t===!0||t===!1||"[object Boolean]"==s.call(t)},A.isNull=function(t){return null===t},A.isUndefined=function(t){return void 0===t},A.has=function(t,n){return f.call(t,n)},A.noConflict=function(){return t._=n,this},A.identity=function(t){return t},A.constant=function(t){return function(){return t}},A.property=function(t){return function(n){return n[t]}},A.matches=function(t){return function(n){if(n===t)return!0;for(var r in t)if(t[r]!==n[r])return!1;return!0}},A.times=function(t,n,r){for(var e=Array(Math.max(0,t)),i=0;t>i;i++)e[i]=n.call(r,i);return e},A.random=function(t,n){return null==n&&(n=t,t=0),t+Math.floor(Math.random()*(n-t+1))},A.now=Date.now||function(){return(new Date).getTime()};var C={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};C.unescape=A.invert(C.escape);var M={escape:new RegExp("["+A.keys(C.escape).join("")+"]","g"),unescape:new RegExp("("+A.keys(C.unescape).join("|")+")","g")};A.each(["escape","unescape"],function(t){A[t]=function(n){return null==n?"":(""+n).replace(M[t],function(n){return C[t][n]})}}),A.result=function(t,n){if(null==t)return void 0;var r=t[n];return A.isFunction(r)?r.call(t):r},A.mixin=function(t){j(A.functions(t),function(n){var r=A[n]=t[n];A.prototype[n]=function(){var t=[this._wrapped];return a.apply(t,arguments),D.call(this,r.apply(A,t))}})};var z=0;A.uniqueId=function(t){var n=++z+"";return t?t+n:n},A.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var T=/(.)^/,B={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},I=/\\|'|\r|\n|\t|\u2028|\u2029/g;A.template=function(t,n,r){var e;r=A.defaults({},r,A.templateSettings);var i=new RegExp([(r.escape||T).source,(r.interpolate||T).source,(r.evaluate||T).source].join("|")+"|$","g"),o=0,u="__p+='";t.replace(i,function(n,r,e,i,a){return u+=t.slice(o,a).replace(I,function(t){return"\\"+B[t]}),r&&(u+="'+\n((__t=("+r+"))==null?'':_.escape(__t))+\n'"),e&&(u+="'+\n((__t=("+e+"))==null?'':__t)+\n'"),i&&(u+="';\n"+i+"\n__p+='"),o=a+n.length,n}),u+="';\n",r.variable||(u="with(obj||{}){\n"+u+"}\n"),u="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+u+"return __p;\n";try{e=new Function(r.variable||"obj","_",u)}catch(a){throw a.source=u,a}if(n)return e(n,A);var c=function(t){return e.call(this,t,A)};return c.source="function("+(r.variable||"obj")+"){\n"+u+"}",c},A.chain=function(t){return A(t).chain()};var D=function(t){return this._chain?A(t).chain():t};A.mixin(A),j(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var n=i[t];A.prototype[t]=function(){var r=this._wrapped;return n.apply(r,arguments),"shift"!=t&&"splice"!=t||0!==r.length||delete r[0],D.call(this,r)}}),j(["concat","join","slice"],function(t){var n=i[t];A.prototype[t]=function(){return D.call(this,n.apply(this._wrapped,arguments))}}),A.extend(A.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}}),"function"==typeof r&&r.amd&&r("underscore",[],function(){return A})}.call(this),r("core",["underscore"],function(t){function n(n){t.each(n,function(n){function r(n){if(t.isObject(n)&&t.has(n,"sync")){var r=n.sync;return e(r)}return n}var u=i[n.type],a=u.callback,c=t.map(u.required_args,function(t){return r(n.args[t])}),l=t.reduce(t.extend(u.optional_args,t.omit.apply(null,[n.args].concat(u.required_args))),function(t,n,e){return t[e]=r(n),t},{});c.push(l),o[n.uuid]=a.apply(null,c)})}function r(t,n,r,e){i[t]={required_args:n,optional_args:r,callback:e}}function e(t){return o[t]}var i={},o={};return{register_parser:r,parse:n,get:e}}),function(){function t(t,n,r){var e=n&&r||0,i=0;for(n=n||[],t.toLowerCase().replace(/[0-9a-f]{2}/g,function(t){16>i&&(n[e+i++]=h[t])});16>i;)n[e+i++]=0;return n}function e(t,n){var r=n||0,e=d;return e[t[r++]]+e[t[r++]]+e[t[r++]]+e[t[r++]]+"-"+e[t[r++]]+e[t[r++]]+"-"+e[t[r++]]+e[t[r++]]+"-"+e[t[r++]]+e[t[r++]]+"-"+e[t[r++]]+e[t[r++]]+e[t[r++]]+e[t[r++]]+e[t[r++]]+e[t[r++]]}function i(t,n,r){var i=n&&r||0,o=n||[];t=t||{};var u=null!=t.clockseq?t.clockseq:v,a=null!=t.msecs?t.msecs:(new Date).getTime(),c=null!=t.nsecs?t.nsecs:_+1,l=a-x+(c-_)/1e4;if(0>l&&null==t.clockseq&&(u=u+1&16383),(0>l||a>x)&&null==t.nsecs&&(c=0),c>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");x=a,_=c,v=u,a+=122192928e5;var s=(1e4*(268435455&a)+c)%4294967296;o[i++]=s>>>24&255,o[i++]=s>>>16&255,o[i++]=s>>>8&255,o[i++]=255&s;var f=a/4294967296*1e4&268435455;o[i++]=f>>>8&255,o[i++]=255&f,o[i++]=f>>>24&15|16,o[i++]=f>>>16&255,o[i++]=u>>>8|128,o[i++]=255&u;for(var p=t.node||m,d=0;6>d;d++)o[i+d]=p[d];return n?n:e(o)}function o(t,n,r){var i=n&&r||0;"string"==typeof t&&(n="binary"==t?new p(16):null,t=null),t=t||{};var o=t.random||(t.rng||u)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,n)for(var a=0;16>a;a++)n[i+a]=o[a];return n||e(o)}var u,a=this;if("function"==typeof n)try{var c=n("crypto").randomBytes;u=c&&function(){return c(16)}}catch(l){}if(!u&&a.crypto&&crypto.getRandomValues){var s=new Uint8Array(16);u=function(){return crypto.getRandomValues(s),s}}if(!u){var f=new Array(16);u=function(){for(var t,n=0;16>n;n++)0===(3&n)&&(t=4294967296*Math.random()),f[n]=t>>>((3&n)<<3)&255;return f}}for(var p="function"==typeof Buffer?Buffer:Array,d=[],h={},g=0;256>g;g++)d[g]=(g+256).toString(16).substr(1),h[d[g]]=g;var y=u(),m=[1|y[0],y[1],y[2],y[3],y[4],y[5]],v=16383&(y[6]<<8|y[7]),x=0,_=0,w=o;if(w.v1=i,w.v4=o,w.parse=t,w.unparse=e,w.BufferClass=p,"function"==typeof r&&r.amd)r("node-uuid",[],function(){return w});else if("undefined"!=typeof module&&module.exports)module.exports=w;else{var b=a.uuid;w.noConflict=function(){return a.uuid=b,w},a.uuid=w}}.call(this),r("parser/stage2d",["underscore","node-uuid","core"],function(t,n,r){return["stage2d",["sheets"],{margin:{x:40,y:10},width:500,height:500},function(n,e){var i=d3.select(document.createElementNS("http://www.w3.org/2000/svg","svg")).style({width:e.width,height:e.height}),o=i.append("g").attr("transform","translate("+e.margin.x+","+e.margin.y+")").attr("class","root"),u=o.append("g").attr("class","sheets_root");return t.each(n,function(t){var n=r.get(t),e=n.node();u.node().appendChild(e)}),i}]}),r("utils/dataframe",["underscore"],function(t){function n(n){this.raw=n;var r=t.keys(n[0]),e=t.zip.apply(this,t.map(n,function(n){return t.toArray(n)})),i=t.filter(e,function(n){return t.all(n,function(n){return t.isArray(n)})});return this.nested=1==i.length?r[e.indexOf(i[0])]:!1,this.filters={},this}return n.prototype.row=function(t){return this.raw[t]},n.prototype.column=function(n){var r=[],e=this.raw;return t.each(e,function(t){r.push(t[n])}),r},n.prototype.scale=function(n,r){if(this.isContinuous(n)){var e=this.columnRange(n);return e=t.range(e.min,e.max+1,(e.max-e.min)/(r.length-1)),d3.scale.linear().domain(e).range(r)}return d3.scale.ordinal().domain(t.uniq(this.column(n))).range(r)},n.prototype.isContinuous=function(n){return t.every(this.column(n),function(n){return t.isNumber(n)})},n.prototype.addFilter=function(t,n,r){this.filters[t]={func:n,excepts:r}},n.prototype.columnWithFilters=function(n,r){var e=this.raw.concat();return t.each(this.filters,function(r,i){(-1==r.excepts.indexOf("self")||i!=n)&&(n in r.excepts||(e=t.filter(e,r.func)))}),t.map(e,function(t){return t[r]})},n.prototype.pickUpCells=function(n,r){var e=this.column(n);return t.map(r,function(t){return e[t]})},n.prototype.getPartialDf=function(n){return t.map(this.raw,function(r){return t.reduce(n,function(t,n){return t[n]=r[n],t},{})})},n.prototype.nested_column=function(t,r){if(!this.nested)throw"Recieved dataframe is not nested.";var e=new n("",this.row(t)[this.nested]);return e.column(r)},n.prototype.columnRange=function(t){var n=this.column(t);return{max:d3.max(n,function(t){return t}),min:d3.min(n,function(t){return t})}},n}),r("parser/scale",["underscore","core","utils/dataframe"],function(){return["scale",["domain","range","type"],{},function(t,n,r){return d3.scale[r]().domain(t).range(n)}]}),r("parser/position",["underscore"],function(){return["position2d",["x","y"],{},function(t,n){return function(r,e){return{x:t(r),y:n(e)}}}]}),r("parser/pane",["underscore","core"],function(t,n){return["pane",["parent_id","layout"],{},function(r,e){var i=d3.select("#"+r),o=function(r,e){if(!t.has(e,"type")){var i=n.get(e.sync);return void r.node().appendChild(i.node())}switch(e.type){case"columns":var u=r.append("div").style({display:"table"});t.each(e.contents,function(t){var n=u.append("div").style("display","table-cell");o(n,t)});break;case"rows":var a=r.append("div");t.each(e.contents,function(t){var n=a.append("div");o(n,t)});break;default:return}};o(i,e)}]}),r("parser/data",[],function(){return["data",["data"],{},function(t){return t}]}),r("parser/row_scale",["underscore","core","utils/dataframe"],function(t,n,r){return["row_scale",["data","column","range"],{},function(t,n,e){var i=new r(t),o=i.scale(n,e);return function(t){return o(t[n])}}]}),r("parser/df_scale",["underscore","core","utils/dataframe"],function(t,n,r){return["df_scale",["data","column","range"],{},function(t,n,e){var i=new r(t);return i.scale(n,e)}]}),r("parser/init",["underscore","core","parser/stage2d","parser/scale","parser/position","parser/pane","parser/data","parser/row_scale","parser/df_scale"],function(t,n){var r=[].slice.call(arguments,2);return function(){t.each(r,function(t){n.register_parser.apply(n,t)})}}),r("glyph",["underscore","core"],function(t,n){function r(t,r,e,i){r.shift(),n.register_parser(t,r,e,function(){var t=[].slice.call(arguments,0),n=d3.select(document.createElementNS("http://www.w3.org/2000/svg","g"));return t.unshift(n),i.apply(null,t)})}return{register_glyph:r}}),r("glyph/scatter",["underscore"],function(){return["scatter",["context","data","x","y","position"],{color:"steelblue",shape:"circle",size:100,stroke_color:"black",stroke_width:1,hover:!0},function(t,n,r,e,i,o){var u=t.selectAll("path").data(n);return u.enter().append("path").attr("transform",function(t){var n=i(t[r],t[e]);return"translate("+n.x+","+n.y+")"}).attr("fill",o.color).attr("stroke",o.stroke_color).attr("stroke-width",o.stroke_width).transition().duration(200).attr("d",d3.svg.symbol().type(o.shape).size(o.size)),u}]}),r("glyph/line",["underscore"],function(){return["line",["context","data","x","y","position"],{color:"steelblue",stroke_width:2},function(t,n,r,e,i,o){var u=t.append("path").datum(n),a=d3.svg.line().x(function(t){return i(t[r],t[e]).x}).y(function(t){return i(t[r],t[e]).y});return u.attr("d",a).attr("stroke",o.color).attr("stroke-width",o.stroke_width).attr("fill","none"),u}]}),r("glyph/histogram",["underscore"],function(t){return["histogram",["context","data","value","position","scalex"],{bin_num:20,width:.9,color:"steelblue",stroke_color:"black",stroke_width:1,hover:!0},function(n,r,e,i,o,u){var a=t.map(r,function(t){return t[e]});d3.layout.histogram().bins(o.ticks(u.bin_num))(a);var c=n.selectAll("rect").data(r);return c.enter().append("rect").attr("height",0).attr("y",i(0,0).y),c.attr("x",function(t){return(t.x,0).x}).attr("width",function(t){return i(t.dx,0).x-i(0,0).x}).attr("fill",u.color).attr("stroke",u.stroke_color).attr("stroke-width",u.stroke_width).transition().duration(200).attr("y",function(t){return i(0,t.y).y}).attr("height",function(t){return i(0,0).y-i(0,t.y).y}),c}]}),r("glyph/vectors",["underscore"],function(){return["vectors",["context","data","x","y","dx","dy","position"],{color:"steelblue",stroke_color:"#000",stroke_width:2,hover:!0},function(t,n,r,e,i,o,u,a){var c=t.selectAll("line").data(n);return c.enter().append("line").attr({x1:function(t){return u(t[r],t[e]).x},x2:function(t){return u(t[r]+t[i],t[e]+t[o]).x},y1:function(t){return u(t[r],t[e]).y},y2:function(t){return u(t[r]+t[i],t[e]+t[o]).y},fill:a.color,stroke:a.stroke_color,"stroke-width":a.stroke_width}),c}]}),r("glyph/rect",["underscore"],function(t){return["rect",["context","data","x","y"],{width:100,height:100,color:"steelblue",stroke_width:1,stroke_color:"black",y_base:"top",x_base:"left"},function(n,r,e,i,o){return n.selectAll("rect").data(r).enter().append("rect").attr({x:e,y:i,width:o.width,height:o.height,fill:o.color,stroke_width:o.stroke_width,stroke:o.stroke_color,transform:function(n){return"center"==o.x_base?t.isFunction(o.width)?function(t){return n+" translate("+o.width(t)/2+",0)"}:n+" translate("+o.width/2+",0)":n}("bottom"==o.y_base?"scale(1, -1)":"")})}]}),r("glyph/circle",["underscore"],function(){return["circle",["context","data","cx","cy"],{radius:100,color:"steelblue",stroke_width:1,stroke_color:"black"},function(t,n,r,e,i){return t.selectAll("circle").data(n).enter().append("circle").attr({cx:r,cy:e,r:i.radius,fill:i.color,stroke_width:i.stroke_width,stroke:i.stroke_color})}]}),r("glyph/init",["underscore","glyph","glyph/scatter","glyph/line","glyph/histogram","glyph/vectors","glyph/rect","glyph/circle"],function(t,n){var r=[].slice.call(arguments,2);return function(){t.each(r,function(t){n.register_glyph.apply(n,t)})}}),r("sheet",["underscore","core"],function(t,n){function r(t,r,e,i){r.shift(),n.register_parser(t,r,e,function(){var t=[].slice.call(arguments,0),n=d3.select(document.createElementNS("http://www.w3.org/2000/svg","g"));return t.unshift(n),i.apply(null,t),n})}return{register_sheet:r}}),r("sheet/axis",["underscore"],function(){return["axis2d",["context","xscale","yscale","width","height"],{margin:{top:0,bottom:0,left:0,right:0},stroke_color:"#fff",stroke_width:1,grid:!0},function(t,n,r,e,i,o){var u=d3.svg.axis().scale(n).orient("bottom"),a=d3.svg.axis().scale(r).orient("left"),c=t.append("g");return c.append("g").attr("class","x_axis"),c.append("g").attr("class","y_axis"),o.grid&&(u.tickSize(-1*i),a.tickSize(-1*e)),c.select(".x_axis").call(u),c.select(".y_axis").call(a),c.selectAll(".x_axis, .y_axis").selectAll("path, line").style("fill","none").style("stroke",o.stroke_color).style("stroke-width",o.stroke_width),c.selectAll(".x_axis, .y_axis").selectAll("text").attr("fill","rgb(50,50,50)"),c.selectAll(".x_axis").attr("transform","translate(0,"+(i+4)+")"),c.selectAll(".y_axis").attr("transform","translate(-4,0)"),c}]}),r("sheet/background",[],function(){return["background2d",["context","width","height"],{bg_color:"#eee",stroke_width:1,stroke_color:"#666"},function(t,n,r,e){var i=t.append("g").attr("class","background");return i.append("rect").attr({x:0,y:0,width:n,height:r,fill:e.bg_color,stroke:e.stroke_color,"stroke-width":e.stroke_width}),i}]}),r("sheet/label",[],function(){return["label",["context","width","height","x","y"],{margin:{top:0,bottom:0,left:0,right:0},rotate_x:0,rotate_y:0},function(t,n,r,e,i,o){var u=t.append("g");return u.append("text").attr("x",n/2).attr("y",r+o.margin.bottom/1.5).attr("text-anchor","middle").attr("fill","rgb(50,50,50)").attr("font-size",22).text(e),u.append("text").attr("x",-o.margin.left/1.5).attr("y",r/2).attr("text-anchor","middle").attr("fill","rgb(50,50,50)").attr("font-size",22).attr("transform","rotate(-90,"+-o.margin.left/1.5+","+r/2+")").text(i),0!=o.rotate_y&&u.selectAll(".y_axis").selectAll("text").style("text-anchor","end").attr("transform",function(){return"rotate("+o.rotate_y+")"}),0!=o.rotate_x&&u.selectAll(".x_axis").selectAll("text").style("text-anchor","end").attr("transform",function(){return"rotate("+o.rotate_x+")"}),u}]}),r("sheet/context",["underscore","node-uuid","core"],function(t,n,r){return["context2d",["parent","glyphs"],{width:500,height:500},function(e,i,o){var u=n.v4()+"clip_context",a=e.append("g").attr("class","context");a.attr("clip-path","url(#"+u+")").append("clipPath").attr("id",u).append("rect").attr({x:0,y:0,width:o.width,height:o.height});var c=a.append("g");t.each(i,function(t){var n=r.get(t),e=n.node().parentNode;c.node().appendChild(e)})}]}),r("sheet/init",["underscore","sheet","sheet/axis","sheet/background","sheet/label","sheet/context"],function(t,n){var r=[].slice.call(arguments,2);return function(){t.each(r,function(t){n.register_sheet.apply(n,t)})}}),r("main",["require","exports","module","parser/init","glyph/init","sheet/init","core","glyph","sheet"],function(t){return t("parser/init")(),t("glyph/init")(),t("sheet/init")(),{core:t("core"),glyph_manager:t("glyph"),sheet_manager:t("sheet")}}),n("main")});